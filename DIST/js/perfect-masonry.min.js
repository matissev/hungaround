!function(t){var o=null,i=null,r=null;t.extend(t.Isotope.prototype,{isFirstRun:!0,_perfectMasonryReset:function(){this.options.perfectMasonry=this.options.perfectMasonry||{};var e="horizontal"!=this.options.perfectMasonry.layout,s=1==this.options.perfectMasonry.liquid;this.isFirstRun&&(this.isFirstRun=!1,o=this,i=t(this.element.context),r=i.parent(),this.options.perfectMasonry.minCols=this.options.perfectMasonry.minCols||1,this.options.perfectMasonry.minRows=this.options.perfectMasonry.minRows||1,this.options.perfectMasonry.maxCols=this.options.perfectMasonry.maxCols||9999,this.options.perfectMasonry.maxRows=this.options.perfectMasonry.maxRows||9999),s&&t.data(window,"events")&&t._data(window,"events").smartresize&&(t(window).off("smartresize.isotope"),t(window).on("resize.isotope.perfectmasonry",function(){i.hasClass("isotope")&&i.isotope("reLayout")}));var n=this.perfectMasonry={};if(this._getSegments(),this._getSegments(!0),this._perfectMasonryGetSegments(),s){var a=r.width(),h=r.height();this.options.perfectMasonry.columnWidth=this.options.perfectMasonry.columnWidth||n.columnWidth,this.options.perfectMasonry.rowHeight=this.options.perfectMasonry.rowHeight||n.rowHeight,n.cols=this.options.perfectMasonry.cols||Math.floor(a/this.options.perfectMasonry.columnWidth),n.rows=this.options.perfectMasonry.rows||Math.floor(h/this.options.perfectMasonry.rowHeight),n.cols=Math.min(Math.max(n.cols,this.options.perfectMasonry.minCols),this.options.perfectMasonry.maxCols),n.rows=Math.min(Math.max(n.rows,this.options.perfectMasonry.minRows),this.options.perfectMasonry.maxRows);var c=e?n.columnWidth/(a/n.cols):n.rowHeight/(h/n.rows);n.columnWidth=Math.floor(n.columnWidth/c),n.rowHeight=Math.floor(n.rowHeight/c)}n.grid=new Array(this.perfectMasonry.cols),n.containerHeight=0,n.containerWidth=0},_perfectMasonryLayout:function(o){var i=this,r=this.perfectMasonry,e="horizontal"!=i.options.perfectMasonry.layout,s=1==i.options.perfectMasonry.liquid;if(r.grid=new Array(r[e?"cols":"rows"]),r.grid&&r.grid.length){o.each(function(){var o=t(this),n=s?o.data("colSpan"):Math.ceil(o.outerWidth()/(r.columnWidth+1)),a=s?o.data("rowSpan"):Math.ceil(o.outerHeight()/(r.rowHeight+1));n||(n=Math.ceil(o.outerWidth(!0)/(r.columnWidth+1)),a=Math.ceil(o.outerHeight(!0)/(r.rowHeight+1)),o.data("colSpan",n),o.data("rowSpan",a));for(var h=e?n:a,c=e?a:n,p=Math.max((e?r.cols-n:r.rows-a)+1,1),f=-1,l=0,M=0;++f<1e4;){r.grid[f]=r.grid[f]||[];for(var d=0;p>d;d++){var g=r.grid[f][d];if(!g){var y=!0;if(n>1||a>1)for(var w=0;h>w;w++){for(var u=0;c>u;u++)if(r.grid[f+u]=r.grid[f+u]||[],r.grid[f+u][d+w]){y=!1;break}if(!y)break}if(y){for(var w=0;h>w;w++)for(var u=0;c>u;u++)r.grid[f+u][d+w]=!0;var l=f,M=d;if(e)var l=d,M=f;return r.containerWidth=Math.max(r.containerWidth,(l+h)*r.columnWidth),r.containerHeight=Math.max(r.containerHeight,(M+c)*r.rowHeight),1==i.options.perfectMasonry.liquid&&o.css({width:r.columnWidth*n,height:r.rowHeight*a}),i._pushPosition(o,l*r.columnWidth,M*r.rowHeight),void 0}}}}i._pushPosition(o,-9999,-9999)});var n=e?r.grid.length:r.grid[0]&&r.grid[0].length,a=e?r.grid[0]&&r.grid[0].length:r.grid.length;t(this.element.context).attr("data-isotope-rows",n).attr("data-isotope-cols",a)}},_perfectMasonryGetContainerSize:function(){return{width:this.perfectMasonry.containerWidth,height:this.perfectMasonry.containerHeight}},_perfectMasonryResizeChanged:function(){var t=this.perfectMasonry,o=t.cols,i=t.rows;return this._perfectMasonryGetSegments(),"horizontal"==this.options.perfectMasonry.layout&&i!==t.rows?!0:o!==t.cols?!0:!1},_perfectMasonryGetSegments:function(){var t=this.perfectMasonry,o=this.options.perfectMasonry.parent||this.element.parent(),i=o.width();t.cols=Math.floor(i/t.columnWidth)||1;var r=o.height();t.rows=Math.floor(r/t.rowHeight)||1}})}(jQuery);